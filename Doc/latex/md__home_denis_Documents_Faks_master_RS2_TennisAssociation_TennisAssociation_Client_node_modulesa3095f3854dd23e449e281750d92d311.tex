Walk any kind of tree structure depth-\/ or breadth-\/first. Supports promises and advanced map-\/reduce operations with a very small API.

Treeverse does not care what kind of tree it is, it will traverse it for you just fine. It does the right thing with functions that return Promises, and returns a non-\/\+Promise value if your functions don\textquotesingle{}t return Promises.

Rather than imposing a specific structure, like requiring you to have child nodes stored in a {\ttfamily children} array, it calls the supplied {\ttfamily get\+Children()} function, so the children can be anywhere (or not even exist yet!) This makes it suitable for {\itshape creating} an optimized tree from a set of dependency manifests, for example.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16289}{}\doxysection{USAGE}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16289}

\begin{DoxyCode}{0}
\DoxyCodeLine{const \{depth, breadth\} = require('treeverse')}
\DoxyCodeLine{}
\DoxyCodeLine{// depth-\/first traversal}
\DoxyCodeLine{// returns a promise if any visit/leave function returns a promise}
\DoxyCodeLine{// otherwise returns the result of leave, or visit if no leave function}
\DoxyCodeLine{// provided.}
\DoxyCodeLine{depth(\{}
\DoxyCodeLine{  // the root node where we start the traversal}
\DoxyCodeLine{  tree: rootNode,}
\DoxyCodeLine{}
\DoxyCodeLine{  visit (node) \{}
\DoxyCodeLine{    // optional}
\DoxyCodeLine{    // called upon descent into the node.}
\DoxyCodeLine{    // return a promise, or a mapped value, or nothing to just leave it}
\DoxyCodeLine{    // as-\/is}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  leave (node, children) \{}
\DoxyCodeLine{    // optional}
\DoxyCodeLine{    // called as we ascend back to the root of the tree.}
\DoxyCodeLine{    // return a promise, or a reduced value, or nothing to leave it as is}
\DoxyCodeLine{    // the children array is a list of the child nodes that have been}
\DoxyCodeLine{    // visited (and potentially left) already.  If the tree is acyclic,}
\DoxyCodeLine{    // then leave() will have been called on all of them.  If it has}
\DoxyCodeLine{    // cycles, then the children may not have been left yet.}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  getChildren (node, nodeResult) \{}
\DoxyCodeLine{    // required}
\DoxyCodeLine{    // return an array of child nodes in the tree, if any exist}
\DoxyCodeLine{    // returning a promise is totally ok, of course.}
\DoxyCodeLine{    // the first argument is the original value of the node.  The second}
\DoxyCodeLine{    // argument is the result of visit(node).}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  filter (node) \{}
\DoxyCodeLine{    // optional}
\DoxyCodeLine{    // return true if the node should be visited, false otherwise}
\DoxyCodeLine{    // initial tree is always visited, so this only filters children}
\DoxyCodeLine{    // note that filtering a node \_also\_ filters all of its children.}
\DoxyCodeLine{  \},}
\DoxyCodeLine{\})}
\DoxyCodeLine{}
\DoxyCodeLine{// breadth first traversal}
\DoxyCodeLine{// returns a promise if any visit function returns a promise}
\DoxyCodeLine{// otherwise returns the result of the top-\/level node.}
\DoxyCodeLine{// note that only a visit() function is supported here, since a node's}
\DoxyCodeLine{// children are typically traversed much later in the process.}
\DoxyCodeLine{breadth(\{}
\DoxyCodeLine{  // the root node where we start the traversal}
\DoxyCodeLine{  tree: rootNode,}
\DoxyCodeLine{}
\DoxyCodeLine{  visit (node) \{}
\DoxyCodeLine{    // optional, but a no-\/op if not provided.}
\DoxyCodeLine{    // called when this node is encountered in the traversal.}
\DoxyCodeLine{    // return a promise, or a mapped value, or nothing to leave as-\/is.}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  getChildren (node, nodeResult) \{}
\DoxyCodeLine{    // required, same as depth()}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  filter (node) \{}
\DoxyCodeLine{    // optional, same as depth()}
\DoxyCodeLine{  \},}
\DoxyCodeLine{\})}

\end{DoxyCode}
\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16290}{}\doxysection{API}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16290}
Both functions take a single options object as an argument, and return either the result value, or a Promise to the result value if the methods in the options argument ever return a Promise.


\begin{DoxyItemize}
\item {\ttfamily treeverse.\+breadth} -\/ Perform a breadth-\/first traversal. That is, walk across node siblings before traversing node children.
\item {\ttfamily treeverse.\+depth} -\/ Perform a depth-\/first traversal. That is, walk down into child nodes before traversing siblings.
\end{DoxyItemize}\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16291}{}\doxysection{OPTIONS}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16291}
All function options can return a Promise or actual value.

The return value is the result of the top level visit function if no leave function is provided, or leave. If any method along the way returns a promise, then the top level function will return a promise which resolves to the result of visiting (and leaving) the top node in the tree.


\begin{DoxyItemize}
\item {\ttfamily tree} -\/ The initial node where the traversal begins.
\item {\ttfamily visit(node)} -\/ Function to call upon visiting a node.
\item {\ttfamily leave(node, children)} -\/ (Depth only) Function to call upon leaving a node, once all of its children have been visited, and potentially left. {\ttfamily children} is an array of child node visit results. If the graph is cyclic, then some children {\itshape may} have been visited but not left.
\item {\ttfamily get\+Children(node, node\+Result)} -\/ Get an array of child nodes to process.
\item {\ttfamily filter} -\/ Filter out child nodes from the traversal. Note that this filters the entire branch of the tree, not just that one node. That is, children of filtered nodes are not traversed either.
\end{DoxyItemize}\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16292}{}\doxysection{STACK DEPTH WARNING}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesa3095f3854dd23e449e281750d92d311_autotoc_md16292}
When a {\ttfamily leave} method is specified, then recursion is used, because maintaining state otherwise is challenging. This means that using {\ttfamily leave} with a synchronous depth first traversal of very deeply nested trees will result in stack overflow errors.

To avoid this, either make one or more of the functions async, or do all of the work in the {\ttfamily visit} method.

Breadth-\/first traversal always uses a loop, and is stack-\/safe.

It is {\itshape possible} to implement depth first traversal with a leave method using a loop rather than recursion, but maintaining the {\ttfamily leave(node, \mbox{[}children\mbox{]})} API surface would be challenging, and is not implemented at this time. 