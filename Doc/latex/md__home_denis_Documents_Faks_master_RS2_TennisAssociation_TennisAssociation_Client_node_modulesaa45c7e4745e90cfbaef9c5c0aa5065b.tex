Configuration management for the npm cli.

This module is the spiritual descendant of \href{http://npm.im/npmconf}{\texttt{ {\ttfamily npmconf}}}, and the code that once lived in npm\textquotesingle{}s {\ttfamily lib/config/} folder.

It does the management of configuration files that npm uses, but importantly, does {\itshape not} define all the configuration defaults or types, as those parts make more sense to live within the npm CLI itself.

The only exceptions\+:


\begin{DoxyItemize}
\item The {\ttfamily prefix} config value has some special semantics, setting the local prefix if specified on the CLI options and not in global mode, or the global prefix otherwise.
\item The {\ttfamily project} config file is loaded based on the local prefix (which can only be set by the CLI config options, and otherwise defaults to a walk up the folder tree to the first parent containing a {\ttfamily node\+\_\+modules} folder, {\ttfamily package.\+json} file, or {\ttfamily package-\/lock.\+json} file.)
\item The {\ttfamily userconfig} value, as set by the environment and CLI (defaulting to {\ttfamily $\sim$/.npmrc}, is used to load user configs.
\item The {\ttfamily globalconfig} value, as set by the environment, CLI, and {\ttfamily userconfig} file (defaulting to {\ttfamily \$\+PREFIX/etc/npmrc}) is used to load global configs.
\item A {\ttfamily builtin} config, read from a {\ttfamily npmrc} file in the root of the npm project itself, overrides all defaults.
\end{DoxyItemize}

The resulting hierarchy of configs\+:


\begin{DoxyItemize}
\item CLI switches. eg {\ttfamily -\/-\/some-\/key=some-\/value} on the command line. These are parsed by \href{http://npm.im/nopt}{\texttt{ {\ttfamily nopt}}}, which is not a great choice, but it\textquotesingle{}s the one that npm has used forever, and changing it will be difficult.
\item Environment variables. eg {\ttfamily npm\+\_\+config\+\_\+some\+\_\+key=some\+\_\+value} in the environment. There is no way at this time to modify this prefix.
\item INI-\/formatted project configs. eg {\ttfamily some-\/key = some-\/value} in the {\ttfamily local\+Prefix} folder (ie, the {\ttfamily cwd}, or its nearest parent that contains either a {\ttfamily node\+\_\+modules} folder or {\ttfamily package.\+json} file.)
\item INI-\/formatted userconfig file. eg {\ttfamily some-\/key = some-\/value} in {\ttfamily $\sim$/.npmrc}. The {\ttfamily userconfig} config value can be overridden by the {\ttfamily cli}, {\ttfamily env}, or {\ttfamily project} configs to change this value.
\item INI-\/formatted globalconfig file. eg {\ttfamily some-\/key = some-\/value} in the {\ttfamily global\+Prefix} folder, which is inferred by looking at the location of the node executable, or the {\ttfamily prefix} setting in the {\ttfamily cli}, {\ttfamily env}, {\ttfamily project}, or {\ttfamily userconfig}. The {\ttfamily globalconfig} value at any of those levels can override this.
\item INI-\/formatted builtin config file. eg {\ttfamily some-\/key = some-\/value} in {\ttfamily /usr/local/lib/node\+\_\+modules/npm/npmrc}. This is not configurable, and is determined by looking in the {\ttfamily npm\+Path} folder.
\item Default values (passed in by npm when it loads this module).
\end{DoxyItemize}\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15429}{}\doxysection{USAGE}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15429}

\begin{DoxyCode}{0}
\DoxyCodeLine{const Config = require('@npmcli/config')}
\DoxyCodeLine{// the types of all the configs we know about}
\DoxyCodeLine{const types = require('./config/types.js')}
\DoxyCodeLine{// default values for all the configs we know about}
\DoxyCodeLine{const defaults = require('./config/defaults.js')}
\DoxyCodeLine{// if you want -\/c to be short for -\/-\/call and so on, define it here}
\DoxyCodeLine{const shorthands = require('./config/shorthands.js')}
\DoxyCodeLine{}
\DoxyCodeLine{const conf = new Config(\{}
\DoxyCodeLine{  // path to the npm module being run}
\DoxyCodeLine{  npmPath: resolve(\_\_dirname, '..'),}
\DoxyCodeLine{  types,}
\DoxyCodeLine{  shorthands,}
\DoxyCodeLine{  defaults,}
\DoxyCodeLine{  // optional, defaults to process.argv}
\DoxyCodeLine{  argv: process.argv,}
\DoxyCodeLine{  // optional, defaults to process.env}
\DoxyCodeLine{  env: process.env,}
\DoxyCodeLine{  // optional, defaults to process.execPath}
\DoxyCodeLine{  execPath: process.execPath,}
\DoxyCodeLine{  // optional, defaults to process.platform}
\DoxyCodeLine{  platform: process.platform,}
\DoxyCodeLine{  // optional, defaults to process.cwd()}
\DoxyCodeLine{  cwd: process.cwd(),}
\DoxyCodeLine{  // optional, defaults to emitting 'log' events on process object}
\DoxyCodeLine{  // only silly, verbose, warn, and error are logged by this module}
\DoxyCodeLine{  log: require('npmlog')}
\DoxyCodeLine{\})}
\DoxyCodeLine{}
\DoxyCodeLine{// returns a promise that fails if config loading fails, and}
\DoxyCodeLine{// resolves when the config object is ready for action}
\DoxyCodeLine{conf.load().then(() => \{}
\DoxyCodeLine{  console.log('loaded ok! some-\/key = ' + conf.get('some-\/key'))}
\DoxyCodeLine{\}).catch(er => \{}
\DoxyCodeLine{  console.error('error loading configs!', er)}
\DoxyCodeLine{\})}

\end{DoxyCode}
\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15430}{}\doxysection{API}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15430}
The {\ttfamily Config} class is the sole export.


\begin{DoxyCode}{0}
\DoxyCodeLine{const Config = require('@npmcli/config')}

\end{DoxyCode}
\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15431}{}\doxysubsection{static $<$tt$>$\+Config.\+type\+Defs$<$/tt$>$}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15431}
The type definitions passed to {\ttfamily nopt} for CLI option parsing and known configuration validation.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15432}{}\doxysubsection{constructor $<$tt$>$new Config(options)$<$/tt$>$}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15432}
Options\+:


\begin{DoxyItemize}
\item {\ttfamily types} Types of all known config values. Note that some are effectively given semantic value in the config loading process itself.
\item {\ttfamily shorthands} An object mapping a shorthand value to an array of CLI arguments that replace it.
\item {\ttfamily defaults} Default values for each of the known configuration keys. These should be defined for all configs given a type, and must be valid.
\item {\ttfamily npm\+Path} The path to the {\ttfamily npm} module, for loading the {\ttfamily builtin} config file.
\item {\ttfamily cwd} Optional, defaults to {\ttfamily \mbox{\hyperlink{namespaceupdate-gyp_a353f325a85a850b0456a7cbaff8fc43b}{process.\+cwd()}}}, used for inferring the {\ttfamily local\+Prefix} and loading the {\ttfamily project} config.
\item {\ttfamily platform} Optional, defaults to {\ttfamily process.\+platform}. Used when inferring the {\ttfamily global\+Prefix} from the {\ttfamily exec\+Path}, since this is done diferently on Windows.
\item {\ttfamily exec\+Path} Optional, defaults to {\ttfamily process.\+exec\+Path}. Used to infer the {\ttfamily global\+Prefix}.
\item {\ttfamily log} Optional, the object used to log debug messages, warnings, and errors. Defaults to emitting on the {\ttfamily process} object.
\item {\ttfamily env} Optional, defaults to {\ttfamily process.\+env}. Source of the environment variables for configuration.
\item {\ttfamily argv} Optional, defaults to {\ttfamily process.\+argv}. Source of the CLI options used for configuration.
\end{DoxyItemize}

Returns a {\ttfamily config} object, which is not yet loaded.

Fields\+:


\begin{DoxyItemize}
\item {\ttfamily config.\+global\+Prefix} The prefix for {\ttfamily global} operations. Set by the {\ttfamily prefix} config value, or defaults based on the location of the {\ttfamily exec\+Path} option.
\item {\ttfamily config.\+local\+Prefix} The prefix for {\ttfamily local} operations. Set by the {\ttfamily prefix} config value on the CLI only, or defaults to either the {\ttfamily cwd} or its nearest ancestor containing a {\ttfamily node\+\_\+modules} folder or {\ttfamily package.\+json} file.
\item {\ttfamily config.\+sources} A read-\/only {\ttfamily Map} of the file (or a comment, if no file found, or relevant) to the config level loaded from that source.
\item {\ttfamily config.\+data} A {\ttfamily Map} of config level to {\ttfamily Config\+Data} objects. These objects should not be modified directly under any circumstances.
\begin{DoxyItemize}
\item {\ttfamily source} The source where this data was loaded from.
\item {\ttfamily raw} The raw data used to generate this config data, as it was parsed initially from the environment, config file, or CLI options.
\item {\ttfamily data} The data object reflecting the inheritance of configs up to this point in the chain.
\item {\ttfamily load\+Error} Any errors encountered that prevented the loading of this config data.
\end{DoxyItemize}
\item {\ttfamily config.\+list} A list sorted in priority of all the config data objects in the prototype chain. {\ttfamily config.\+list\mbox{[}0\mbox{]}} is the {\ttfamily cli} level, {\ttfamily config.\+list\mbox{[}1\mbox{]}} is the {\ttfamily env} level, and so on.
\item {\ttfamily cwd} The {\ttfamily cwd} param
\item {\ttfamily env} The {\ttfamily env} param
\item {\ttfamily argv} The {\ttfamily argv} param
\item {\ttfamily exec\+Path} The {\ttfamily exec\+Path} param
\item {\ttfamily platform} The {\ttfamily platform} param
\item {\ttfamily log} The {\ttfamily log} param
\item {\ttfamily defaults} The {\ttfamily defaults} param
\item {\ttfamily shorthands} The {\ttfamily shorthands} param
\item {\ttfamily types} The {\ttfamily types} param
\item {\ttfamily npm\+Path} The {\ttfamily npm\+Path} param
\item {\ttfamily global\+Prefix} The effective {\ttfamily global\+Prefix}
\item {\ttfamily local\+Prefix} The effective {\ttfamily local\+Prefix}
\item {\ttfamily prefix} If `config.\+get(\textquotesingle{}global'){\ttfamily is true, then}global\+Prefix{\ttfamily , otherwise}local\+Prefix{\ttfamily  -\/}home{\ttfamily The user\textquotesingle{}s home directory, found by looking at}env.\+HOME$<$tt$>$or callingos.\+homedir(){\ttfamily . -\/}loaded{\ttfamily A boolean indicating whether or not configs are loaded -\/}valid{\ttfamily A getter that returns}true{\ttfamily if all the config objects are valid. Any data objects that have been modified with}config.\+set(...){\ttfamily will be re-\/evaluated when}config.\+valid\`{} is read.
\end{DoxyItemize}\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15433}{}\doxysubsection{$<$tt$>$config.\+load()$<$/tt$>$}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15433}
Load configuration from the various sources of information.

Returns a {\ttfamily Promise} that resolves when configuration is loaded, and fails if a fatal error is encountered.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15434}{}\doxysubsection{$<$tt$>$config.\+find(key)$<$/tt$>$}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15434}
Find the effective place in the configuration levels a given key is set. Returns one of\+: {\ttfamily cli}, {\ttfamily env}, {\ttfamily project}, {\ttfamily user}, {\ttfamily global}, {\ttfamily builtin}, or {\ttfamily default}.

Returns {\ttfamily null} if the key is not set.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15435}{}\doxysubsection{‘config.\+get(key, where = \textquotesingle{}cli’)\`{}}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15435}
Load the given key from the config stack.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15436}{}\doxysubsection{‘config.\+set(key, value, where = \textquotesingle{}cli’)\`{}}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15436}
Set the key to the specified value, at the specified level in the config stack.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15437}{}\doxysubsection{‘config.\+delete(key, where = \textquotesingle{}cli’)\`{}}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15437}
Delete the configuration key from the specified level in the config stack.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15438}{}\doxysubsection{$<$tt$>$config.\+validate(where)$<$/tt$>$}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15438}
Verify that all known configuration options are set to valid values, and log a warning if they are invalid.

If {\ttfamily where} is not set, then all config objects are validated.

Returns {\ttfamily true} if all configs are valid.

Note that it\textquotesingle{}s usually enough (and more efficient) to just check {\ttfamily config.\+valid}, since each data object is marked for re-\/evaluation on every {\ttfamily config.\+set()} operation.\hypertarget{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15439}{}\doxysubsection{$<$tt$>$config.\+save(where)$<$/tt$>$}\label{md__home_denis_Documents_Faks_master_RS2_TennisAssociation_TennisAssociation_Client_node_modulesaa45c7e4745e90cfbaef9c5c0aa5065b_autotoc_md15439}
Save the config file specified by the {\ttfamily where} param. Must be one of {\ttfamily project}, {\ttfamily user}, {\ttfamily global}, {\ttfamily builtin}. 