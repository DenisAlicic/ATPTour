<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tennis Association: libnpmaccess</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tennis Association
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle">
<div class="title">libnpmaccess </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p class=""><a href="https://npm.im/libnpmaccess"><img src="https://img.shields.io/npm/v/libnpmaccess.svg" alt="npm version" style="pointer-events: none;" class="inline"/></a> <a href="https://npm.im/libnpmaccess"><img src="https://img.shields.io/npm/l/libnpmaccess.svg" alt="license" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/npm/libnpmaccess/actions?query=workflow%3A%22Node+CI%22"><img src="https://github.com/npm/libnpmaccess/workflows/Node%20CI/badge.svg" alt="GitHub Actions" style="pointer-events: none;" class="inline"/></a> <a href="https://coveralls.io/github/npm/libnpmaccess?branch=latest"><img src="https://coveralls.io/repos/github/npm/libnpmaccess/badge.svg?branch=latest" alt="Coverage Status" style="pointer-events: none;" class="inline"/></a></p>
<p class=""><a href="https://github.com/npm/libnpmaccess"><code>libnpmaccess</code></a> is a Node.js library that provides programmatic access to the guts of the npm CLI's <code>npm access</code> command and its various subcommands. This includes managing account 2FA, listing packages and permissions, looking at package collaborators, and defining package permissions for users, orgs, and teams.</p>
<h1><a class="anchor" id="autotoc_md15162"></a>
Example</h1>
<div class="fragment"><div class="line">const access = require(&#39;libnpmaccess&#39;)</div>
<div class="line"> </div>
<div class="line">// List all packages @zkat has access to on the npm registry.</div>
<div class="line">console.log(Object.keys(await access.lsPackages(&#39;zkat&#39;)))</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md15163"></a>
Table of Contents</h1>
<ul>
<li><a href="#install">Installing</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#contributing">Contributing</a></li>
<li><a href="#api">API</a><ul>
<li><a href="#opts">access opts</a></li>
<li><a href="#public"><code>public()</code></a></li>
<li><a href="#restricted"><code>restricted()</code></a></li>
<li><a href="#grant"><code>grant()</code></a></li>
<li><a href="#revoke"><code>revoke()</code></a></li>
<li><a href="#tfa-required"><code>tfaRequired()</code></a></li>
<li><a href="#tfa-not-required"><code>tfaNotRequired()</code></a></li>
<li><a href="#ls-packages"><code>lsPackages()</code></a></li>
<li><a href="#ls-packages-stream"><code>lsPackages.stream()</code></a></li>
<li><a href="#ls-collaborators"><code>lsCollaborators()</code></a></li>
<li><a href="#ls-collaborators-stream"><code>lsCollaborators.stream()</code></a></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md15164"></a>
Install</h2>
<p class=""><code>$ npm install libnpmaccess</code></p>
<h2><a class="anchor" id="autotoc_md15165"></a>
API</h2>
<h3><a class="anchor" id="autotoc_md15166"></a>
&lt;a name="opts"&gt;&lt;/a&gt; &lt;tt&gt;opts&lt;/tt&gt; for &lt;tt&gt;libnpmaccess&lt;/tt&gt; commands</h3>
<p class=""><code>libnpmaccess</code> uses <a href="https://npm.im/npm-registry-fetch"><code>npm-registry-fetch</code></a>. All options are passed through directly to that library, so please refer to [its own <code>opts</code> documentation](<a href="https://www.npmjs.com/package/npm-registry-fetch#fetch-options">https://www.npmjs.com/package/npm-registry-fetch#fetch-options</a>) for options that can be passed in.</p>
<p class="">A couple of options of note for those in a hurry:</p>
<ul>
<li><code>opts.token</code> - can be passed in and will be used as the authentication token for the registry. For other ways to pass in auth details, see the n-r-f docs.</li>
<li><code>opts.otp</code> - certain operations will require an OTP token to be passed in. If a <code>libnpmaccess</code> command fails with <code>err.code === EOTP</code>, please retry the request with <code>{otp: &lt;2fa token&gt;}</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md15167"></a>
&lt;a name="public"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.public(spec, [opts]) -&gt; Promise&lt;Boolean&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec.</p>
<p class="">Makes package described by <code>spec</code> public.</p>
<h4><a class="anchor" id="autotoc_md15168"></a>
Example</h4>
<div class="fragment"><div class="line">await access.public(&#39;@foo/bar&#39;, {token: &#39;myregistrytoken&#39;})</div>
<div class="line">// `@foo/bar` is now public</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15169"></a>
&lt;a name="restricted"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.restricted(spec, [opts]) -&gt; Promise&lt;Boolean&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec.</p>
<p class="">Makes package described by <code>spec</code> private/restricted.</p>
<h4><a class="anchor" id="autotoc_md15170"></a>
Example</h4>
<div class="fragment"><div class="line">await access.restricted(&#39;@foo/bar&#39;, {token: &#39;myregistrytoken&#39;})</div>
<div class="line">// `@foo/bar` is now private</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15171"></a>
&lt;a name="grant"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.grant(spec, team, permissions, [opts]) -&gt; Promise&lt;Boolean&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec. <code>team</code> must be a fully-qualified team name, in the <code>scope:team</code> format, with or without the <code>@</code> prefix, and the team must be a valid team within that scope. <code>permissions</code> must be one of &lsquo;'read-only&rsquo;<code>or</code>'read-write'`.</p>
<p class="">Grants <code>read-only</code> or <code>read-write</code> permissions for a certain package to a team.</p>
<h4><a class="anchor" id="autotoc_md15172"></a>
Example</h4>
<div class="fragment"><div class="line">await access.grant(&#39;@foo/bar&#39;, &#39;@foo:myteam&#39;, &#39;read-write&#39;, {</div>
<div class="line">  token: &#39;myregistrytoken&#39;</div>
<div class="line">})</div>
<div class="line">// `@foo/bar` is now read/write enabled for the @foo:myteam team.</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15173"></a>
&lt;a name="revoke"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.revoke(spec, team, [opts]) -&gt; Promise&lt;Boolean&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec. <code>team</code> must be a fully-qualified team name, in the <code>scope:team</code> format, with or without the <code>@</code> prefix, and the team must be a valid team within that scope. <code>permissions</code> must be one of &lsquo;'read-only&rsquo;<code>or</code>'read-write'`.</p>
<p class="">Removes access to a package from a certain team.</p>
<h4><a class="anchor" id="autotoc_md15174"></a>
Example</h4>
<div class="fragment"><div class="line">await access.revoke(&#39;@foo/bar&#39;, &#39;@foo:myteam&#39;, {</div>
<div class="line">  token: &#39;myregistrytoken&#39;</div>
<div class="line">})</div>
<div class="line">// @foo:myteam can no longer access `@foo/bar`</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15175"></a>
&lt;a name="tfa-required"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.tfaRequired(spec, [opts]) -&gt; Promise&lt;Boolean&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec.</p>
<p class="">Makes it so publishing or managing a package requires using 2FA tokens to complete operations.</p>
<h4><a class="anchor" id="autotoc_md15176"></a>
Example</h4>
<div class="fragment"><div class="line">await access.tfaRequires(&#39;lodash&#39;, {token: &#39;myregistrytoken&#39;})</div>
<div class="line">// Publishing or changing dist-tags on `lodash` now require OTP to be enabled.</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15177"></a>
&lt;a name="tfa-not-required"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.tfaNotRequired(spec, [opts]) -&gt; Promise&lt;Boolean&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec.</p>
<p class="">Disabled the package-level 2FA requirement for <code>spec</code>. Note that you will need to pass in an <code>otp</code> token in <code>opts</code> in order to complete this operation.</p>
<h4><a class="anchor" id="autotoc_md15178"></a>
Example</h4>
<div class="fragment"><div class="line">await access.tfaNotRequired(&#39;lodash&#39;, {otp: &#39;123654&#39;, token: &#39;myregistrytoken&#39;})</div>
<div class="line">// Publishing or editing dist-tags on `lodash` no longer requires OTP to be</div>
<div class="line">// enabled.</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15179"></a>
&lt;a name="ls-packages"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.lsPackages(entity, [opts]) -&gt; Promise&lt;Object | null&gt;&lt;/tt&gt;</h3>
<p class=""><code>entity</code> must be either a valid org or user name, or a fully-qualified team name in the <code>scope:team</code> format, with or without the <code>@</code> prefix.</p>
<p class="">Lists out packages a user, org, or team has access to, with corresponding permissions. Packages that the access token does not have access to won't be listed.</p>
<p class="">In order to disambiguate between users and orgs, two requests may end up being made when listing orgs or users.</p>
<p class="">For a streamed version of these results, see <a href="#ls-package-stream"><code>access.lsPackages.stream()</code></a>.</p>
<h4><a class="anchor" id="autotoc_md15180"></a>
Example</h4>
<div class="fragment"><div class="line">await access.lsPackages(&#39;zkat&#39;, {</div>
<div class="line">  token: &#39;myregistrytoken&#39;</div>
<div class="line">})</div>
<div class="line">// Lists all packages `@zkat` has access to on the registry, and the</div>
<div class="line">// corresponding permissions.</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15181"></a>
&lt;a name="ls-packages-stream"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.lsPackages.stream(scope, [team], [opts]) -&gt; Stream&lt;/tt&gt;</h3>
<p class=""><code>entity</code> must be either a valid org or user name, or a fully-qualified team name in the <code>scope:team</code> format, with or without the <code>@</code> prefix.</p>
<p class="">Streams out packages a user, org, or team has access to, with corresponding permissions, with each stream entry being formatted like <code>[packageName, permissions]</code>. Packages that the access token does not have access to won't be listed.</p>
<p class="">In order to disambiguate between users and orgs, two requests may end up being made when listing orgs or users.</p>
<p class="">The returned stream is a valid <code>asyncIterator</code>.</p>
<h4><a class="anchor" id="autotoc_md15182"></a>
Example</h4>
<div class="fragment"><div class="line">for await (let [pkg, perm] of access.lsPackages.stream(&#39;zkat&#39;)) {</div>
<div class="line">  console.log(&#39;zkat has&#39;, perm, &#39;access to&#39;, pkg)</div>
<div class="line">}</div>
<div class="line">// zkat has read-write access to eggplant</div>
<div class="line">// zkat has read-only access to @npmcorp/secret</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15183"></a>
&lt;a name="ls-collaborators"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.lsCollaborators(spec, [user], [opts]) -&gt; Promise&lt;Object | null&gt;&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec. <code>user</code> must be a valid user name, with or without the <code>@</code> prefix.</p>
<p class="">Lists out access privileges for a certain package. Will only show permissions for packages to which you have at least read access. If <code>user</code> is passed in, the list is filtered only to teams <em>that</em> user happens to belong to.</p>
<p class="">For a streamed version of these results, see <a href="#ls-collaborators-stream"><code>access.lsCollaborators.stream()</code></a>.</p>
<h4><a class="anchor" id="autotoc_md15184"></a>
Example</h4>
<div class="fragment"><div class="line">await access.lsCollaborators(&#39;@npm/foo&#39;, &#39;zkat&#39;, {</div>
<div class="line">  token: &#39;myregistrytoken&#39;</div>
<div class="line">})</div>
<div class="line">// Lists all teams with access to @npm/foo that @zkat belongs to.</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15185"></a>
&lt;a name="ls-collaborators-stream"&gt;&lt;/a&gt; &lt;tt&gt;&gt; access.lsCollaborators.stream(spec, [user], [opts]) -&gt; Stream&lt;/tt&gt;</h3>
<p class=""><code>spec</code> must be an <a href="https://npm.im/npm-package-arg"><code>npm-package-arg</code></a>-compatible registry spec. <code>user</code> must be a valid user name, with or without the <code>@</code> prefix.</p>
<p class="">Stream out access privileges for a certain package, with each entry in <code>[user, permissions]</code> format. Will only show permissions for packages to which you have at least read access. If <code>user</code> is passed in, the list is filtered only to teams <em>that</em> user happens to belong to.</p>
<p class="">The returned stream is a valid <code>asyncIterator</code>.</p>
<h4><a class="anchor" id="autotoc_md15186"></a>
Example</h4>
<div class="fragment"><div class="line">for await (let [usr, perm] of access.lsCollaborators.stream(&#39;npm&#39;)) {</div>
<div class="line">  console.log(usr, &#39;has&#39;, perm, &#39;access to npm&#39;)</div>
<div class="line">}</div>
<div class="line">// zkat has read-write access to npm</div>
<div class="line">// iarna has read-write access to npm</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
